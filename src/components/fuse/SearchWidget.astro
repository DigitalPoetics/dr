---
export interface Props {
  label?: string;
  description?: string;
  placeholder?: string;
  redirectUrl?: string;
}

const { 
  label = "Search the Blog",
  description = "Enter a search term or phrase to search the blog.",
  placeholder = "Enter a search termâ€¦",
  redirectUrl = "/fuse"
} = Astro.props;
---

<aside class="form">
    <form >
        <div>
            <label for="search">{label}</label>
            <span>{description}</span>
        </div>
        <input
        type="search"
        required
        min="2"
        max="24"
        name="search"
        id="search"
        placeholder={placeholder}
        />
    </form>
</aside>

<script src="https://cdnjs.cloudflare.com/ajax/libs/dompurify/3.0.8/purify.min.js" is:inline></script>

<script is:inline define:vars={{ redirectUrl }}>
  document.addEventListener("DOMContentLoaded", () => {
    const form = document.querySelector("form");
    form?.addEventListener("submit", (e) => {
      e.preventDefault();
      const formData = new FormData(form);
      const searchTerm = DOMPurify.sanitize(formData.get("search")?.toString());
      if (!searchTerm || searchTerm.length === 0) return;
      const url = new URL(redirectUrl, window.location.origin);
      url.searchParams.set("q", searchTerm);
      window.location.assign(url.toString());
    });
  });
</script>

<style>
    #search {
      /* width: 100%; */
      height: 1.3rem;
    }
</style>